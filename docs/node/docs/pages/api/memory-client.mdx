---
title: "MemoryClient"
description: "A convenient viem-based client that bundles Tevm Node functionalities—forking, testing, and wallet actions—into a single interface."
---

# MemoryClient

**MemoryClient** combines a fully in-memory Ethereum node powered by [Tevm Node](/introduction/what-is-tevm-node) with [viem](https://viem.sh/). It includes:

1. **Public actions** – All standard viem [public actions](https://viem.sh/docs/actions/public/introduction).
2. **Wallet actions** – Sign transactions, send ETH, deploy contracts, etc.
3. **Test actions** – Ganache/Hardhat-like commands (`mine`, `setBalance`, `impersonateAccount`, etc.).
4. **Tevm Node's own** advanced actions – e.g. `tevmCall`, `tevmContract`, `tevmDeploy`.

:::callout
**Power vs. Modularity**
While **MemoryClient** is the most convenient way to use Tevm, it's less tree-shakeable than the lower-level approach (`createTevmNode` + separate "actions"). For many dev/test use cases, MemoryClient's all-in-one experience is ideal.
:::

## Installation

```bash
npm install tevm
```

## Basic Usage

```typescript
import { createMemoryClient } from 'tevm'

// Create a simple memory client
const client = createMemoryClient()

// Get current block number
const blockNumber = await client.getBlockNumber()
```

## Forking

Fork from any EVM-compatible network:

```typescript
import { createMemoryClient, http } from 'tevm'
import { optimism } from 'tevm/common'

const forkedClient = createMemoryClient({
  fork: {
    transport: http('https://mainnet.optimism.io')({}),
    blockTag: 'latest',
  },
  common: optimism,
})
```

## Contract Interactions

### Deploying Contracts

```typescript
import { SimpleContract } from 'tevm/contract'
import { privateKeyToAccount } from 'viem/accounts'

const signerAccount = privateKeyToAccount('0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa')
const memoryClient = createMemoryClient({
  account: signerAccount,
})

// Deploy SimpleContract with initial value = 2
const txHash = await memoryClient.deployContract(SimpleContract.deploy(2n))
await memoryClient.mine({ blocks: 1 })

// Get the deployment receipt
const receipt = await memoryClient.getTransactionReceipt({ hash: txHash })
const contractAddress = receipt.contractAddress

// Create contract instance
const contract = SimpleContract.withAddress(contractAddress)

// Read from the contract
const currentValue = await memoryClient.readContract(contract.read.get())

// Write to the contract
const setHash = await memoryClient.writeContract(contract.write.set(420n))
await memoryClient.mine({ blocks: 1 })
```

### Interacting with Existing Contracts

```typescript
import { ERC20 } from 'tevm/contract'

// DAI on Optimism
const Dai = ERC20.withAddress('0xDA10009cBd5D07dd0CeCc66161FC93D7c9000da1')

// Read balance of an address
const balance = await memoryClient.readContract(
  Dai.read.balanceOf('0xf0d4c12a5768d806021f80a262b4d39d26c58b8d')
)
```

## Test Actions

### Time Manipulation

```typescript
// Increase block timestamp
await client.increaseTime({ seconds: 3600 }) // 1 hour

// Set next block timestamp
await client.setNextBlockTimestamp({ timestamp: 1234567890n })
```

### State Snapshots

```typescript
// Take snapshot
const snap = await client.snapshot()

// Make changes...

// Revert to snapshot
await client.revert({ id: snap })
```

### Account Management

```typescript
// Set account balance
await client.setBalance({
  address: '0x...',
  value: parseEther('100')
})

// Impersonate account
await client.impersonateAccount({ address: '0x...' })

// Stop impersonating
await client.stopImpersonatingAccount({ address: '0x...' })
```

## Mining Configuration

Configure how transactions are processed:

```typescript
// Auto-mine every transaction
const autoMiningClient = createMemoryClient({
  miningConfig: { type: 'auto' }
})

// Mine on interval
const intervalMiningClient = createMemoryClient({
  miningConfig: {
    type: 'interval',
    interval: 1000 // 1 second
  }
})

// Manual mining
const manualMiningClient = createMemoryClient({
  miningConfig: { type: 'manual' }
})

// Mine blocks manually
await manualMiningClient.mine({ blocks: 1 })
```

## Error Handling

The client includes comprehensive error handling:

```typescript
try {
  await client.writeContract(contract.write.transfer(to, amount))
} catch (e) {
  if (e.message.includes('insufficient funds')) {
    // Handle insufficient funds error
  }
  throw e
}
```

## See Also
- [What is Tevm Node?](../introduction/what-is-tevm-node)
- [Creating a Node](../core/create-tevm-node)
- [Viem Documentation](https://viem.sh)