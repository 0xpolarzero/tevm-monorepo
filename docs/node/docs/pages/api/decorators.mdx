# @tevm/decorators

The `@tevm/decorators` package provides a set of decorators and APIs for extending Tevm clients with additional functionality. It includes implementations for both standard Ethereum JSON-RPC methods and Tevm-specific actions.

## Installation

```bash
npm install @tevm/decorators
```

## Main APIs

### EthActionsApi

The `EthActionsApi` provides standard Ethereum JSON-RPC methods for interacting with the VM. These actions correspond 1:1 with the public Ethereum JSON-RPC API.

```typescript
import { type EthActionsApi } from '@tevm/decorators'

interface EthActionsApi {
  eth: {
    // Returns the current block number
    blockNumber: EthBlockNumberHandler
    // Executes a call without modifying the state
    call: EthCallHandler
    // Returns the current chain id
    chainId: EthChainIdHandler
    // Returns the current gas price
    gasPrice: EthGasPriceHandler
    // Returns the balance of a given address
    getBalance: EthGetBalanceHandler
    // Returns code at a given address
    getCode: EthGetCodeHandler
    // Returns storage at a given address and slot
    getStorageAt: EthGetStorageAtHandler
  }
}
```

### TevmActionsApi

The `TevmActionsApi` provides Tevm-specific actions for enhanced VM interaction and state management.

```typescript
import { type TevmActionsApi } from '@tevm/decorators'

interface TevmActionsApi {
  // Sets the state of a specific ethereum address
  setAccount: SetAccountHandler
  // Gets the state of a specific ethereum address
  getAccount: GetAccountHandler
  // Executes a call against the VM with extended options
  call: CallHandler
  // Executes a contract call with typesafe API
  contract: ContractHandler
  // Dumps the current state of the VM
  dumpState: DumpStateHandler
  // Loads a previously dumped state
  loadState: LoadStateHandler
  // Mines blocks
  mine: MineHandler
  // Deploys a contract
  deploy: DeployHandler
  // Deals ERC20 tokens to an account
  deal: AnvilDealHandler
}
```

### TevmSendApi

The `TevmSendApi` provides low-level JSON-RPC request handling capabilities.

```typescript
import { type TevmSendApi } from '@tevm/decorators'

interface TevmSendApi {
  send: TevmJsonRpcRequestHandler
  sendBulk: TevmJsonRpcBulkRequestHandler
}
```

## Decorators

### ethActions

A decorator function that extends a client with standard Ethereum JSON-RPC methods.

```typescript
import { ethActions } from '@tevm/decorators'

const clientWithEth = client.extend(ethActions())
// Now you can use eth methods
await clientWithEth.eth.blockNumber()
```

### tevmActions

A decorator function that extends a client with Tevm-specific actions.

```typescript
import { tevmActions } from '@tevm/decorators'

const clientWithTevm = client.extend(tevmActions())
// Now you can use Tevm actions
await clientWithTevm.call({
  to: '0x123...',
  data: '0x456...'
})
```

## Examples

### Using EthActionsApi

```typescript
// Get current block number
const blockNumber = await client.eth.blockNumber()
console.log(blockNumber) // 0n

// Get balance of an address
const balance = await client.eth.getBalance({
  address: '0x123...',
  tag: 'pending'
})
console.log(balance) // 0n

// Execute a call
const result = await client.eth.call({
  to: '0x123...',
  data: '0x456...'
})
```

### Using TevmActionsApi

```typescript
// Set account state
await client.setAccount({
  address: '0x123...',
  deployedBytecode: '0x6080604...',
  balance: parseEther('1.0')
})

// Execute contract call
const result = await client.contract({
  to: '0x123...',
  abi: [...],
  function: 'run',
  args: ['world'],
  from: '0x456...'
})

// Dump and load state
const { state } = await client.dumpState()
await client.loadState({ state })

// Deal tokens
await client.deal({
  erc20: '0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48', // USDC
  account: '0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266',
  amount: 1000000n // 1 USDC (6 decimals)
})
```

## Types

The package includes several additional types for working with Ethereum and EIP-1193:

- `AddEthereumChainParameter`: Parameters for adding a new chain
- `EIP1193Parameters`: Parameters for EIP-1193 requests
- `Hash`: Type for Ethereum hashes
- `LogTopic`: Type for event log topics
- `NetworkSync`: Network synchronization status
- `WalletPermission`: Wallet permission parameters
- `WatchAssetParams`: Parameters for watching assets

## See Also

- [Tevm Actions Documentation](https://tevm.sh/learn/actions/)
- [JSON-RPC API Documentation](https://ethereum.github.io/execution-apis/api-documentation/)